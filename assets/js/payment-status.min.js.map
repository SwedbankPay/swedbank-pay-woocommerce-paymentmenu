{"version":3,"file":"payment-status.min.js","names":["jQuery","$","window","sb_payment_status_check","xhr","attempts","init","this","checkPayment","err","data","status_elm","success_elm","failed_elm","state","hide","show","append","message","setTimeout","callback","block","Swedbank_Pay_Payment_Status_Check","check_message","overlayCSS","background","opacity","ajax","type","url","ajax_url","action","nonce","order_id","order_key","dataType","always","unblock","done","response","document","ready"],"sources":["payment-status.js"],"sourcesContent":["jQuery( function( $ ) {\r\n    'use strict';\r\n\r\n    window.sb_payment_status_check = {\r\n        xhr: false,\r\n        attempts: 0,\r\n\r\n        /**\r\n         * Initialize the checking\r\n         */\r\n        init: function() {\r\n            this.checkPayment( function ( err, data ) {\r\n                var status_elm = $( '#order-status-checking' ),\r\n                    success_elm = $( '#order-success' ),\r\n                    failed_elm = $( '#order-failed' );\r\n\r\n                switch ( data.state ) {\r\n                    case 'paid':\r\n                        status_elm.hide();\r\n                        success_elm.show();\r\n                        break;\r\n                    case 'failed':\r\n                    case 'aborted':\r\n                        status_elm.hide();\r\n                        failed_elm.append(\"<p>\" + data.message + \"</p>\");\r\n                        failed_elm.show();\r\n                        break;\r\n                    default:\r\n                        window.sb_payment_status_check.attempts++;\r\n\r\n                        if ( window.sb_payment_status_check.attempts > 6) {\r\n                            return;\r\n                        }\r\n\r\n                        setTimeout(function () {\r\n                            window.sb_payment_status_check.init();\r\n                        }, 10000);\r\n                }\r\n            } );\r\n        },\r\n\r\n        /**\r\n         * Check payment\r\n         * @return {JQueryPromise<any>}\r\n         */\r\n        checkPayment: function ( callback ) {\r\n            $( '.woocommerce-order' ).block( {\r\n                message: Swedbank_Pay_Payment_Status_Check.check_message,\r\n                overlayCSS: {\r\n                    background: '#fff',\r\n                    opacity: 0.6\r\n                }\r\n            } );\r\n\r\n            return $.ajax( {\r\n                type: 'POST',\r\n                url: Swedbank_Pay_Payment_Status_Check.ajax_url,\r\n                data: {\r\n                    action: 'swedbank_pay_check_payment_status',\r\n                    nonce: Swedbank_Pay_Payment_Status_Check.nonce,\r\n                    order_id: Swedbank_Pay_Payment_Status_Check.order_id,\r\n                    order_key: Swedbank_Pay_Payment_Status_Check.order_key,\r\n                },\r\n                dataType: 'json'\r\n            } ).always( function() {\r\n                $( '.woocommerce-order' ).unblock();\r\n            } ).done( function ( response ) {\r\n                callback( null, response.data );\r\n            } );\r\n        },\r\n    };\r\n\r\n    $(document).ready( function () {\r\n        window.sb_payment_status_check.init();\r\n    } );\r\n} );\r\n"],"mappings":"AAAAA,QAAQ,SAAUC,GACd,aAEAC,OAAOC,wBAA0B,CAC7BC,KAAK,EACLC,SAAU,EAKVC,KAAM,WACFC,KAAKC,cAAc,SAAWC,EAAKC,GAC/B,IAAIC,EAAaV,EAAG,0BAChBW,EAAcX,EAAG,kBACjBY,EAAaZ,EAAG,iBAEpB,OAASS,EAAKI,OACV,IAAK,OACDH,EAAWI,OACXH,EAAYI,OACZ,MACJ,IAAK,SACL,IAAK,UACDL,EAAWI,OACXF,EAAWI,OAAO,MAAQP,EAAKQ,QAAU,QACzCL,EAAWG,OACX,MACJ,QAGI,GAFAd,OAAOC,wBAAwBE,WAE1BH,OAAOC,wBAAwBE,SAAW,EAC3C,OAGJc,YAAW,WACPjB,OAAOC,wBAAwBG,MACnC,GAAG,KAEf,GACJ,EAMAE,aAAc,SAAWY,GASrB,OARAnB,EAAG,sBAAuBoB,MAAO,CAC7BH,QAASI,kCAAkCC,cAC3CC,WAAY,CACRC,WAAY,OACZC,QAAS,MAIVzB,EAAE0B,KAAM,CACXC,KAAM,OACNC,IAAKP,kCAAkCQ,SACvCpB,KAAM,CACFqB,OAAQ,oCACRC,MAAOV,kCAAkCU,MACzCC,SAAUX,kCAAkCW,SAC5CC,UAAWZ,kCAAkCY,WAEjDC,SAAU,SACVC,QAAQ,WACRnC,EAAG,sBAAuBoC,SAC9B,IAAIC,MAAM,SAAWC,GACjBnB,EAAU,KAAMmB,EAAS7B,KAC7B,GACJ,GAGJT,EAAEuC,UAAUC,OAAO,WACfvC,OAAOC,wBAAwBG,MACnC,GACJ"}