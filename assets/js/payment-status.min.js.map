{"version":3,"file":"payment-status.min.js","names":["jQuery","$","window","sb_payment_status_check","xhr","attempts","init","this","checkPayment","err","data","status_elm","success_elm","failed_elm","state","hide","show","append","message","setTimeout","callback","block","Swedbank_Pay_Payment_Status_Check","check_message","overlayCSS","background","opacity","ajax","type","url","ajax_url","action","nonce","order_id","order_key","dataType","always","unblock","done","response","document","ready"],"sources":["payment-status.js"],"sourcesContent":["jQuery( function( $ ) {\n    'use strict';\n\n    window.sb_payment_status_check = {\n        xhr: false,\n        attempts: 0,\n\n        /**\n         * Initialize the checking\n         */\n        init: function() {\n            this.checkPayment( function ( err, data ) {\n                var status_elm = $( '#order-status-checking' ),\n                    success_elm = $( '#order-success' ),\n                    failed_elm = $( '#order-failed' );\n\n                switch ( data.state ) {\n                    case 'paid':\n                        status_elm.hide();\n                        success_elm.show();\n                        break;\n                    case 'failed':\n                    case 'aborted':\n                        status_elm.hide();\n                        failed_elm.append(\"<p>\" + data.message + \"</p>\");\n                        failed_elm.show();\n                        break;\n                    default:\n                        window.sb_payment_status_check.attempts++;\n\n                        if ( window.sb_payment_status_check.attempts > 6) {\n                            return;\n                        }\n\n                        setTimeout(function () {\n                            window.sb_payment_status_check.init();\n                        }, 10000);\n                }\n            } );\n        },\n\n        /**\n         * Check payment\n         * @return {JQueryPromise<any>}\n         */\n        checkPayment: function ( callback ) {\n            $( '.woocommerce-order' ).block( {\n                message: Swedbank_Pay_Payment_Status_Check.check_message,\n                overlayCSS: {\n                    background: '#fff',\n                    opacity: 0.6\n                }\n            } );\n\n            return $.ajax( {\n                type: 'POST',\n                url: Swedbank_Pay_Payment_Status_Check.ajax_url,\n                data: {\n                    action: 'swedbank_pay_check_payment_status',\n                    nonce: Swedbank_Pay_Payment_Status_Check.nonce,\n                    order_id: Swedbank_Pay_Payment_Status_Check.order_id,\n                    order_key: Swedbank_Pay_Payment_Status_Check.order_key,\n                },\n                dataType: 'json'\n            } ).always( function() {\n                $( '.woocommerce-order' ).unblock();\n            } ).done( function ( response ) {\n                callback( null, response.data );\n            } );\n        },\n    };\n\n    $(document).ready( function () {\n        window.sb_payment_status_check.init();\n    } );\n} );\n"],"mappings":"AAAAA,QAAQ,SAAUC,GACd,aAEAC,OAAOC,wBAA0B,CAC7BC,KAAK,EACLC,SAAU,EAKVC,KAAM,WACFC,KAAKC,cAAc,SAAWC,EAAKC,GAC/B,IAAIC,EAAaV,EAAG,0BAChBW,EAAcX,EAAG,kBACjBY,EAAaZ,EAAG,iBAEpB,OAASS,EAAKI,OACV,IAAK,OACDH,EAAWI,OACXH,EAAYI,OACZ,MACJ,IAAK,SACL,IAAK,UACDL,EAAWI,OACXF,EAAWI,OAAO,MAAQP,EAAKQ,QAAU,QACzCL,EAAWG,OACX,MACJ,QAGI,GAFAd,OAAOC,wBAAwBE,WAE1BH,OAAOC,wBAAwBE,SAAW,EAC3C,OAGJc,YAAW,WACPjB,OAAOC,wBAAwBG,MACnC,GAAG,KAEf,GACJ,EAMAE,aAAc,SAAWY,GASrB,OARAnB,EAAG,sBAAuBoB,MAAO,CAC7BH,QAASI,kCAAkCC,cAC3CC,WAAY,CACRC,WAAY,OACZC,QAAS,MAIVzB,EAAE0B,KAAM,CACXC,KAAM,OACNC,IAAKP,kCAAkCQ,SACvCpB,KAAM,CACFqB,OAAQ,oCACRC,MAAOV,kCAAkCU,MACzCC,SAAUX,kCAAkCW,SAC5CC,UAAWZ,kCAAkCY,WAEjDC,SAAU,SACVC,QAAQ,WACRnC,EAAG,sBAAuBoC,SAC9B,IAAIC,MAAM,SAAWC,GACjBnB,EAAU,KAAMmB,EAAS7B,KAC7B,GACJ,GAGJT,EAAEuC,UAAUC,OAAO,WACfvC,OAAOC,wBAAwBG,MACnC,GACJ"}